include:
  - ../test-compose.yml
services:
  ksml_v1_1:
#    image: axual/ksml:local
#    pull_policy: missing
    image: axual/ksml:snapshot
    pull_policy: always
    hostname: ksml-test
    restart: no
    ports:
      - 8080:8080
      - 9999:9999
    # Using this non-standard directory to verify nothing is hardcoded to the image default /ksml
    volumes:
      - ./definitions:/notDefaultKsml
    working_dir: /notDefaultKsml
    command:
      - /notDefaultKsml/ksml-runner-minimal.yaml
    depends_on:
      broker:
        condition: service_healthy
      schema_registry:
        condition: service_healthy
      prepare_cluster:
        condition: service_completed_successfully
        restart: false

